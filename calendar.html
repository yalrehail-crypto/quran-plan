<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</title>
  <style>
    :root{
      --bg:#081426;
      --card:#0f2140cc;
      --text:#ffffff;
      --muted:#b9c6df;
      --muted2:#93a4c6;
      --shadow: 0 20px 50px rgba(0,0,0,.35);
      --radius: 22px;
      --border: rgba(255,255,255,.10);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 50% -200px, #143261 0%, var(--bg) 55%, #050b14 100%);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:24px 14px 60px;
    }

    .wrap{ width:min(920px, 100%); }

    .header{
      background: linear-gradient(180deg, rgba(14,33,70,.95), rgba(10,22,45,.92));
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 26px;
      box-shadow: var(--shadow);
      padding: 22px 18px 18px;
      margin-bottom: 14px;
      text-align:center;
    }

    .title{
      font-weight: 1000;
      letter-spacing:.5px;
      font-size: clamp(30px, 6vw, 52px);
      margin: 4px 0 6px;
    }
    .sub{
      color: var(--muted);
      font-weight: 800;
      font-size: clamp(14px, 2.2vw, 18px);
      margin: 0 0 6px;
      line-height: 1.8;
    }
    .time{
      color: var(--muted);
      font-weight: 800;
      font-size: 18px;
      margin-top: 8px;
    }

    /* Grid cards Ù…Ø«Ù„ Ø§Ù„ØµÙˆØ±Ø© */
    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 14px;
    }

    .menuCard{
      position: relative;
      border-radius: 18px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.06);
      overflow:hidden;
      box-shadow: 0 12px 35px rgba(0,0,0,.22);
      min-height: 110px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition: transform .08s ease, filter .08s ease;
      padding: 16px;
    }
    .menuCard:active{ transform: scale(.99); }

    /* Ø²Ø®Ø§Ø±Ù Ø®ÙÙŠÙØ© */
    .menuCard::before{
      content:"";
      position:absolute;
      inset:-40px -40px auto auto;
      width:160px;
      height:160px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 60%);
      transform: rotate(18deg);
      pointer-events:none;
      opacity:.45;
    }
    .menuCard::after{
      content:"";
      position:absolute;
      inset:auto -60px -60px auto;
      width:220px;
      height:220px;
      background: radial-gradient(circle at 40% 40%, rgba(255,255,255,.25), transparent 60%);
      transform: rotate(-10deg);
      pointer-events:none;
      opacity:.35;
    }

    .menuText{
      text-align:center;
      font-weight: 1000;
      font-size: clamp(20px, 3.6vw, 34px);
      line-height: 1.2;
      z-index: 1;
      padding: 6px 10px;
      text-shadow: 0 6px 18px rgba(0,0,0,.35);
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap: wrap;
      justify-content:center;
    }
    .emoji{
      font-size: 1.1em;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.25));
    }

    /* Ø£Ù„ÙˆØ§Ù† ÙƒÙ„ Ø®ÙŠØ§Ø± */
    .c-school{ background: linear-gradient(135deg, rgba(0,170,255,.22), rgba(0,85,255,.10)); }
    .c-salary{ background: linear-gradient(135deg, rgba(0,255,160,.20), rgba(0,120,80,.10)); }
    .c-retire{ background: linear-gradient(135deg, rgba(255,190,0,.22), rgba(140,90,0,.10)); }
    .c-citizen{ background: linear-gradient(135deg, rgba(120,255,120,.20), rgba(30,120,30,.10)); }
    .c-ss{ background: linear-gradient(135deg, rgba(255,210,120,.22), rgba(120,80,20,.10)); }

    @media (max-width: 560px){
      .grid{ grid-template-columns: 1fr; }
      .menuCard{ min-height: 96px; }
    }

    /* Modal */
    .overlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding: 12px;
      z-index: 999;
    }
    .overlay.show{ display:flex; }

    .sheet{
      width:min(860px, 100%);
      background: linear-gradient(180deg, rgba(16,40,86,.98), rgba(10,22,45,.98));
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 26px;
      box-shadow: 0 30px 80px rgba(0,0,0,.55);
      overflow:hidden;
      max-height: 86vh;
      display:flex;
      flex-direction:column;
    }

    .sheetHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 16px 14px;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .sheetTitle{
      display:flex;
      align-items:center;
      gap: 10px;
      font-weight: 1000;
      font-size: 26px;
    }
    .closeBtn{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:#fff;
      border-radius: 16px;
      padding: 10px 14px;
      font-weight: 900;
      font-size: 16px;
      cursor:pointer;
    }

    .sheetBody{
      padding: 14px;
      overflow:auto;
    }

    .topRow{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items:center;
      justify-content:space-between;
      margin-bottom: 12px;
    }

    .pill{
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.92);
      padding: 10px 12px;
      border-radius: 16px;
      font-weight: 900;
      font-size: 14px;
      display:flex;
      align-items:center;
      gap: 8px;
    }

    .select{
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.14);
      color: #fff;
      padding: 10px 12px;
      border-radius: 16px;
      font-weight: 900;
      font-size: 14px;
      outline:none;
    }
    .select option{ color:#000; }

    .list{
      display:grid;
      gap: 12px;
    }

    .item{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      padding: 14px 14px;
      display:flex;
      flex-direction:column;
      gap: 8px;
    }

    .itemTitle{
      font-weight: 1000;
      font-size: 22px;
      line-height: 1.5;
      display:flex;
      align-items:center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .meta{
      color: rgba(255,255,255,.78);
      font-weight: 800;
      font-size: 16px;
      line-height: 1.7;
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .meta span{
      display:inline-flex;
      align-items:center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 14px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
    }

    .countdown{
      margin-top: 6px;
      font-weight: 1000;
      font-size: 18px;
      color: #cfe0ff;
    }

    .hint{
      margin-top: 10px;
      color: rgba(255,255,255,.60);
      font-size: 13px;
      font-weight: 700;
      text-align:center;
      line-height: 1.8;
    }
  </style>
</head>

<body>
  <div class="wrap">

    <div class="header">
      <div class="title">ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© <span style="font-size:.7em;">ğŸ‡¸ğŸ‡¦</span></div>
      <div class="sub" id="hijriText">â€”</div>
      <div class="sub" id="gregText">â€”</div>
      <div class="time" id="clock">â€”</div>
    </div>

    <div class="grid">
      <div class="menuCard c-school" onclick="openSheet('school')">
        <div class="menuText"><span class="emoji">ğŸ“</span> Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</div>
      </div>
      <div class="menuCard c-salary" onclick="openSheet('salary')">
        <div class="menuText"><span class="emoji">ğŸ’°</span> Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø±ÙˆØ§ØªØ¨</div>
      </div>
      <div class="menuCard c-retire" onclick="openSheet('retire')">
        <div class="menuText"><span class="emoji">ğŸ§“</span> Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ù…ØªÙ‚Ø§Ø¹Ø¯ÙŠÙ†</div>
      </div>
      <div class="menuCard c-citizen" onclick="openSheet('citizen')">
        <div class="menuText"><span class="emoji">ğŸ‘¤</span> Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ§Ø·Ù†</div>
      </div>
      <div class="menuCard c-ss" onclick="openSheet('ss')">
        <div class="menuText"><span class="emoji">ğŸ¤</span> Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</div>
      </div>
    </div>

  </div>

  <!-- Modal -->
  <div class="overlay" id="overlay" onclick="closeIfOutside(event)">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="sheetHead">
        <div class="sheetTitle" id="sheetTitle">â€”</div>
        <button class="closeBtn" onclick="closeSheet()">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <div class="sheetBody">
        <div class="topRow" id="topRow"></div>
        <div class="list" id="list"></div>
        <div class="hint" id="hint">â€”</div>
      </div>
    </div>
  </div>

  <script>
    // =========================
    // Ø£Ø¯ÙˆØ§Øª ØªØ§Ø±ÙŠØ®
    // =========================
    const WEEKEND = [5,6]; // Ø§Ù„Ø¬Ù…Ø¹Ø©=5 Ø§Ù„Ø³Ø¨Øª=6 (Ø­Ø³Ø¨ getDay: Ø§Ù„Ø£Ø­Ø¯0 ... Ø§Ù„Ø³Ø¨Øª6)
    function pad2(n){ return String(n).padStart(2,'0'); }

    function formatGreg(date){
      // 2026/2/26
      return `${date.getFullYear()}/${date.getMonth()+1}/${date.getDate()}`;
    }

    function hijriLong(now){
      try{
        return new Intl.DateTimeFormat("ar-SA-u-ca-islamic-umalqura", {
          weekday: "long", day: "numeric", month: "long", year: "numeric"
        }).format(now);
      }catch(e){
        return new Intl.DateTimeFormat("ar-SA-u-ca-islamic", {
          weekday: "long", day: "numeric", month: "long", year: "numeric"
        }).format(now);
      }
    }

    function gregLong(now){
      return new Intl.DateTimeFormat("ar-SA", {
        weekday:"long", day:"numeric", month:"long", year:"numeric"
      }).format(now);
    }

    function timeNow(now){
      return new Intl.DateTimeFormat("ar-SA", { hour:"numeric", minute:"2-digit", second:"2-digit" }).format(now);
    }

    function parseYMD(s){
      // "2026-02-22"
      const [y,m,d] = s.split("-").map(x=>parseInt(x,10));
      return new Date(y, m-1, d, 0, 0, 0, 0);
    }

    function adjustForWeekend(date){
      // Ø¥Ø°Ø§ ØµØ§Ø¯Ù Ø§Ù„Ø¬Ù…Ø¹Ø© Ø£Ùˆ Ø§Ù„Ø³Ø¨Øª: Ù†Ø±Ø¬Ø¹Ù‡ Ù„Ù„Ø®Ù…ÙŠØ³ (Ù‚Ø¨Ù„Ù‡Ø§)
      const d = new Date(date);
      const day = d.getDay();
      if(day === 5){ // Fri
        d.setDate(d.getDate()-1);
      }else if(day === 6){ // Sat
        d.setDate(d.getDate()-2);
      }
      return d;
    }

    function msToCountdown(ms){
      if(ms <= 0) return "âœ… Ø§Ù„ÙŠÙˆÙ… Ù‡Ùˆ Ø§Ù„Ù…ÙˆØ¹Ø¯!";
      const totalSec = Math.floor(ms/1000);
      const days = Math.floor(totalSec / (3600*24));
      const rem1 = totalSec % (3600*24);
      const hrs = Math.floor(rem1 / 3600);
      const rem2 = rem1 % 3600;
      const mins = Math.floor(rem2 / 60);
      const secs = rem2 % 60;
      return `â³ Ø¨Ø§Ù‚ÙŠ: ${days} ÙŠÙˆÙ… â€¢ ${hrs} Ø³Ø§Ø¹Ø© â€¢ ${mins} Ø¯Ù‚ÙŠÙ‚Ø© â€¢ ${secs} Ø«Ø§Ù†ÙŠØ©`;
    }

    function nextFromList(items){
      const now = new Date();
      // items: [{date: Date, ...}]
      const future = items
        .map(x => ({...x, dateObj: (x.dateObj || x.date)}))
        .filter(x => x.dateObj instanceof Date)
        .sort((a,b)=>a.dateObj - b.dateObj);

      for(const it of future){
        const dt = it.dateObj;
        // Ù„Ùˆ Ø§Ù„ÙŠÙˆÙ… Ù†ÙØ³ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù†Ø¹ØªØ¨Ø±Ù‡ Ø§Ù„Ù‚Ø§Ø¯Ù…
        if(dt.getTime() >= new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime()){
          return it;
        }
      }
      return future[future.length-1] || null;
    }

    // =========================
    // 1) Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ (Ù…Ù† ØµÙˆØ±Ùƒ)
    // =========================
    const SCHOOL_GENERAL = [
      { title:"Ø¹ÙˆØ¯Ø© Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ù…Ø´Ø±ÙÙŠÙ† Ø§Ù„ØªØ±Ø¨ÙˆÙŠÙŠÙ† (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§Ø­Ù„)", emoji:"ğŸ«", g:"2025-08-12", h:"1447/2/18" },
      { title:"Ø¹ÙˆØ¯Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† Ø§Ù„Ù…Ù…Ø§Ø±Ø³ÙŠÙ† Ù„Ù„ØªØ¯Ø±ÙŠØ³ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§Ø­Ù„)", emoji:"ğŸ‘©â€ğŸ«", g:"2025-08-17", h:"1447/2/23" },
      { title:"Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ", emoji:"ğŸ’", g:"2025-08-24", h:"1447/3/1" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ÙˆØ·Ù†ÙŠ", emoji:"ğŸ‡¸ğŸ‡¦", g:"2025-09-23", h:"1447/4/1" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø¥Ø¶Ø§ÙÙŠØ©", emoji:"âœ¨", g:"2025-10-12", h:"1447/4/20" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„Ø®Ø±ÙŠÙ (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"ğŸ‚", g:"2025-11-21", h:"1447/5/30", rangeEndG:"2025-11-29", rangeEndH:"1447/6/8" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø¥Ø¶Ø§ÙÙŠØ© (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"âœ¨", g:"2025-12-11", h:"1447/6/20", rangeEndG:"2025-12-14", rangeEndH:"1447/6/23" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ù…Ù†ØªØµÙ Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"ğŸ§Š", g:"2026-01-09", h:"1447/7/20", rangeEndG:"2026-01-17", rangeEndH:"1447/7/28" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© ÙŠÙˆÙ… Ø§Ù„ØªØ£Ø³ÙŠØ³", emoji:"ğŸ›ï¸", g:"2026-02-22", h:"1447/9/5" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø± (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"ğŸŒ™", g:"2026-03-06", h:"1447/9/17", rangeEndG:"2026-03-28", rangeEndH:"1447/10/9" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø¹ÙŠØ¯ Ø§Ù„Ø£Ø¶Ø­Ù‰ (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"ğŸ‘", g:"2026-05-22", h:"1447/12/5", rangeEndG:"2026-06-01", rangeEndH:"1447/12/15" },
      { title:"Ø¨Ø¯Ø§ÙŠØ© Ø¥Ø¬Ø§Ø²Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ", emoji:"ğŸ", g:"2026-06-25", h:"1448/1/10" },
      { title:"Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 1448-1449", emoji:"ğŸ“", g:"2026-08-23", h:"1448/3/10" },
    ];

    const SCHOOL_MAKKAH = [
      { title:"Ø¹ÙˆØ¯Ø© Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ù…Ø´Ø±ÙÙŠÙ† Ø§Ù„ØªØ±Ø¨ÙˆÙŠÙŠÙ† (Ù…ÙƒØ©/Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø¬Ø¯Ø©/Ø§Ù„Ø·Ø§Ø¦Ù)", emoji:"ğŸ«", g:"2025-08-17", h:"1447/2/23" },
      { title:"Ø¹ÙˆØ¯Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† Ø§Ù„Ù…Ù…Ø§Ø±Ø³ÙŠÙ† Ù„Ù„ØªØ¯Ø±ÙŠØ³ (Ù…ÙƒØ©/Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø¬Ø¯Ø©/Ø§Ù„Ø·Ø§Ø¦Ù)", emoji:"ğŸ‘©â€ğŸ«", g:"2025-08-24", h:"1447/3/1" },
      { title:"Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ (Ù…ÙƒØ©/Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø¬Ø¯Ø©/Ø§Ù„Ø·Ø§Ø¦Ù)", emoji:"ğŸ’", g:"2025-08-31", h:"1447/3/8" },
      // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ù†ÙØ³ Ø§Ù„Ø¹Ø§Ù… ØºØ§Ù„Ø¨Ù‹Ø§ (Ø­Ø³Ø¨ ØµÙˆØ±ØªÙƒ)
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ÙˆØ·Ù†ÙŠ", emoji:"ğŸ‡¸ğŸ‡¦", g:"2025-09-23", h:"1447/4/1" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø¥Ø¶Ø§ÙÙŠØ©", emoji:"âœ¨", g:"2025-10-12", h:"1447/4/20" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„Ø®Ø±ÙŠÙ (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"ğŸ‚", g:"2025-11-21", h:"1447/5/30", rangeEndG:"2025-11-29", rangeEndH:"1447/6/8" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø¥Ø¶Ø§ÙÙŠØ© (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"âœ¨", g:"2025-12-11", h:"1447/6/20", rangeEndG:"2025-12-14", rangeEndH:"1447/6/23" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ù…Ù†ØªØµÙ Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"ğŸ§Š", g:"2026-01-09", h:"1447/7/20", rangeEndG:"2026-01-17", rangeEndH:"1447/7/28" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© ÙŠÙˆÙ… Ø§Ù„ØªØ£Ø³ÙŠØ³", emoji:"ğŸ›ï¸", g:"2026-02-22", h:"1447/9/5" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø± (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"ğŸŒ™", g:"2026-03-06", h:"1447/9/17", rangeEndG:"2026-03-28", rangeEndH:"1447/10/9" },
      { title:"Ø¥Ø¬Ø§Ø²Ø© Ø¹ÙŠØ¯ Ø§Ù„Ø£Ø¶Ø­Ù‰ (Ø¨Ø¯Ø§ÙŠØ©)", emoji:"ğŸ‘", g:"2026-05-22", h:"1447/12/5", rangeEndG:"2026-06-01", rangeEndH:"1447/12/15" },
      { title:"Ø¨Ø¯Ø§ÙŠØ© Ø¥Ø¬Ø§Ø²Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ (Ù…ÙƒØ©/Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø¬Ø¯Ø©/Ø§Ù„Ø·Ø§Ø¦Ù)", emoji:"ğŸ", g:"2026-07-02", h:"1448/1/17" },
      { title:"Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 1448-1449 (Ù…ÙƒØ©/Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø¬Ø¯Ø©/Ø§Ù„Ø·Ø§Ø¦Ù)", emoji:"ğŸ“", g:"2026-08-30", h:"1448/3/17" },
    ];

    // =========================
    // 2-5) Ø¨Ù‚ÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ (Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆÙØ©: ØªØ§Ø±ÙŠØ® Ø«Ø§Ø¨Øª + ØªÙ‚Ø¯ÙŠÙ… Ø¥Ø°Ø§ Ø¬Ù…Ø¹Ø©/Ø³Ø¨Øª)
    // =========================
    // Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: ÙŠÙˆÙ… 27 Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±ØŒ Ø¥Ø°Ø§ Ø¬Ù…Ø¹Ø© => 26ØŒ Ø¥Ø°Ø§ Ø³Ø¨Øª => 25
    // Ø§Ù„Ù…ØªÙ‚Ø§Ø¹Ø¯ÙŠÙ†: ÙŠÙˆÙ… 1 Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±ØŒ Ø¥Ø°Ø§ Ø¬Ù…Ø¹Ø© => 30/31ØŒ Ø¥Ø°Ø§ Ø³Ø¨Øª => 29/30
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ§Ø·Ù†: ÙŠÙˆÙ… 10 Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±ØŒ Ø¥Ø°Ø§ Ø¬Ù…Ø¹Ø© => 9ØŒ Ø¥Ø°Ø§ Ø³Ø¨Øª => 8
    // Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ: ÙŠÙˆÙ… 1 Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±ØŒ Ø¥Ø°Ø§ Ø¬Ù…Ø¹Ø©/Ø³Ø¨Øª ØªÙ‚Ø¯ÙŠÙ… Ù…Ø«Ù„ Ø§Ù„Ù…ØªÙ‚Ø§Ø¹Ø¯ÙŠÙ†

    function buildMonthlyDates(ruleDay, monthsCount, startDate, label, emoji){
      const out = [];
      const base = startDate ? new Date(startDate) : new Date();
      const y0 = base.getFullYear();
      const m0 = base.getMonth();

      for(let i=0;i<monthsCount;i++){
        const y = y0 + Math.floor((m0+i)/12);
        const m = (m0+i)%12;

        let d = new Date(y, m, ruleDay, 0,0,0,0);
        d = adjustForWeekend(d);

        // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ù‡Ø± Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ
        const monthName = new Intl.DateTimeFormat("ar-SA", { month:"long", year:"numeric" }).format(new Date(y,m,1));
        out.push({
          title: `${label} (${monthName})`,
          emoji,
          dateObj: d,
          gText: formatGreg(d)
        });
      }
      return out;
    }

    // (Ù…Ù† Ø§Ù„Ø¢Ù† ÙˆÙ„Ù…Ø¯Ø© 18 Ø´Ù‡Ø±) Ø¹Ø´Ø§Ù† Ù…Ø§ ØªØªØ¹Ø¨
    const PAY_SALARY = buildMonthlyDates(27, 18, new Date(), "Ø±Ø§ØªØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†", "ğŸ’°");
    const PAY_RETIRED = buildMonthlyDates(1, 18, new Date(), "Ø±Ø§ØªØ¨ Ø§Ù„Ù…ØªÙ‚Ø§Ø¹Ø¯ÙŠÙ†", "ğŸ§“");
    const PAY_CITIZEN = buildMonthlyDates(10, 18, new Date(), "Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ§Ø·Ù†", "ğŸ‘¤");
    const PAY_SS = buildMonthlyDates(1, 18, new Date(), "Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ", "ğŸ¤");

    // =========================
    // UI: ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ + Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… + Ø§Ù„Ø¹Ø¯Ù‘Ø§Ø¯
    // =========================
    const overlay = document.getElementById("overlay");
    const sheetTitle = document.getElementById("sheetTitle");
    const listEl = document.getElementById("list");
    const topRow = document.getElementById("topRow");
    const hint = document.getElementById("hint");

    let currentView = null; // {key, data, countdownId}

    function closeIfOutside(e){
      if(e.target === overlay) closeSheet();
    }

    function closeSheet(){
      overlay.classList.remove("show");
      if(currentView?.countdownId) clearInterval(currentView.countdownId);
      currentView = null;
    }

    function openSheet(key){
      overlay.classList.add("show");
      if(currentView?.countdownId) clearInterval(currentView.countdownId);

      if(key === "school"){
        renderSchool();
        return;
      }

      if(key === "salary"){
        renderPay("ğŸ’° Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø±ÙˆØ§ØªØ¨", PAY_SALARY, "ğŸ’¡ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©: ÙŠÙˆÙ… 27 Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±ØŒ ÙˆØ¥Ø°Ø§ ØµØ§Ø¯Ù Ø¬Ù…Ø¹Ø©/Ø³Ø¨Øª ÙŠØªÙ… Ø§Ù„ØªÙ‚Ø¯ÙŠÙ….");
        return;
      }
      if(key === "retire"){
        renderPay("ğŸ§“ Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ù…ØªÙ‚Ø§Ø¹Ø¯ÙŠÙ†", PAY_RETIRED, "ğŸ’¡ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©: ÙŠÙˆÙ… 1 Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±ØŒ ÙˆØ¥Ø°Ø§ ØµØ§Ø¯Ù Ø¬Ù…Ø¹Ø©/Ø³Ø¨Øª ÙŠØªÙ… Ø§Ù„ØªÙ‚Ø¯ÙŠÙ….");
        return;
      }
      if(key === "citizen"){
        renderPay("ğŸ‘¤ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ§Ø·Ù†", PAY_CITIZEN, "ğŸ’¡ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©: ÙŠÙˆÙ… 10 Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±ØŒ ÙˆØ¥Ø°Ø§ ØµØ§Ø¯Ù Ø¬Ù…Ø¹Ø©/Ø³Ø¨Øª ÙŠØªÙ… Ø§Ù„ØªÙ‚Ø¯ÙŠÙ….");
        return;
      }
      if(key === "ss"){
        renderPay("ğŸ¤ Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ", PAY_SS, "ğŸ’¡ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©: ÙŠÙˆÙ… 1 Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±ØŒ ÙˆØ¥Ø°Ø§ ØµØ§Ø¯Ù Ø¬Ù…Ø¹Ø©/Ø³Ø¨Øª ÙŠØªÙ… Ø§Ù„ØªÙ‚Ø¯ÙŠÙ….");
        return;
      }
    }

    function renderPay(title, items, hintText){
      sheetTitle.textContent = title;
      topRow.innerHTML = "";

      // Ø¹Ø¯Ù‘Ø§Ø¯ Ù„Ø£Ù‚Ø±Ø¨ Ù…ÙˆØ¹Ø¯
      const next = nextFromList(items);

      const pill1 = document.createElement("div");
      pill1.className = "pill";
      pill1.id = "nextPill";
      pill1.textContent = next ? `ğŸ“Œ Ø£Ù‚Ø±Ø¨ Ù…ÙˆØ¹Ø¯: ${next.gText}` : "ğŸ“Œ Ù„Ø§ ÙŠÙˆØ¬Ø¯";

      const pill2 = document.createElement("div");
      pill2.className = "pill";
      pill2.id = "countdownPill";
      pill2.textContent = "â³ â€”";

      topRow.appendChild(pill1);
      topRow.appendChild(pill2);

      listEl.innerHTML = "";
      for(const it of items){
        const card = document.createElement("div");
        card.className = "item";
        card.innerHTML = `
          <div class="itemTitle">${it.emoji} ${it.title}</div>
          <div class="meta">
            <span>ğŸ“… Ù…ÙŠÙ„Ø§Ø¯ÙŠ: ${it.gText}</span>
          </div>
        `;
        listEl.appendChild(card);
      }

      hint.textContent = hintText;

      // ØªØ´ØºÙŠÙ„ Ø¹Ø¯Ø§Ø¯
      currentView = { key: title, data: items, countdownId: null };
      const countdownPill = document.getElementById("countdownPill");
      function tick(){
        if(!next){ countdownPill.textContent = "â³ â€”"; return; }
        const now = new Date();
        const ms = next.dateObj.getTime() - now.getTime();
        countdownPill.textContent = msToCountdown(ms);
      }
      tick();
      currentView.countdownId = setInterval(tick, 1000);
    }

    function renderSchool(){
      sheetTitle.textContent = "ğŸ“ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ";
      topRow.innerHTML = "";

      // Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…
      const sel = document.createElement("select");
      sel.className = "select";
      sel.id = "schoolSel";
      sel.innerHTML = `
        <option value="general" selected>Ø¹Ø§Ù… (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚)</option>
        <option value="makkah">Ù…ÙƒØ©/Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø¬Ø¯Ø©/Ø§Ù„Ø·Ø§Ø¦Ù</option>
      `;

      const pillA = document.createElement("div");
      pillA.className = "pill";
      pillA.textContent = "ğŸ“Œ Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…";

      const pillB = document.createElement("div");
      pillB.className = "pill";
      pillB.id = "schoolNext";
      pillB.textContent = "ğŸ“Œ Ø£Ù‚Ø±Ø¨ Ø­Ø¯Ø«: â€”";

      const pillC = document.createElement("div");
      pillC.className = "pill";
      pillC.id = "schoolCountdown";
      pillC.textContent = "â³ â€”";

      topRow.appendChild(pillA);
      topRow.appendChild(sel);
      topRow.appendChild(pillB);
      topRow.appendChild(pillC);

      hint.textContent = "âœ… Ù…Ø£Ø®ÙˆØ° Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù„ÙŠ Ø£Ø±Ø³Ù„ØªÙ‡ (ØªØ§Ø±ÙŠØ® Ù‡Ø¬Ø±ÙŠ + Ù…ÙŠÙ„Ø§Ø¯ÙŠ).";

      function paint(which){
        const src = (which === "makkah") ? SCHOOL_MAKKAH : SCHOOL_GENERAL;

        // ØªØ¬Ù‡ÙŠØ² Ø¹Ù†Ø§ØµØ± Ø¨ Date
        const items = src.map(x => ({
          ...x,
          dateObj: parseYMD(x.g)
        })).sort((a,b)=>a.dateObj-b.dateObj);

        const next = nextFromList(items);

        document.getElementById("schoolNext").textContent =
          next ? `ğŸ“Œ Ø£Ù‚Ø±Ø¨ Ø­Ø¯Ø«: ${next.emoji} ${next.title}` : "ğŸ“Œ Ø£Ù‚Ø±Ø¨ Ø­Ø¯Ø«: â€”";

        listEl.innerHTML = "";
        for(const it of items){
          const isRange = it.rangeEndG && it.rangeEndH;
          const gLine = isRange
            ? `Ù…Ù† ${it.g.replaceAll("-","/")} Ø¥Ù„Ù‰ ${it.rangeEndG.replaceAll("-","/")}`
            : it.g.replaceAll("-","/");
          const hLine = isRange
            ? `Ù…Ù† ${it.h} Ø¥Ù„Ù‰ ${it.rangeEndH}`
            : it.h;

          const card = document.createElement("div");
          card.className = "item";
          card.innerHTML = `
            <div class="itemTitle">${it.emoji} ${it.title}</div>
            <div class="meta">
              <span>ğŸ—“ï¸ Ù‡Ø¬Ø±ÙŠ: ${hLine}</span>
              <span>ğŸ“… Ù…ÙŠÙ„Ø§Ø¯ÙŠ: ${gLine}</span>
            </div>
            <div class="countdown" data-date="${it.g}">â³ â€”</div>
          `;
          listEl.appendChild(card);
        }

        // Ø¹Ø¯Ø§Ø¯ Ù„Ø£Ù‚Ø±Ø¨ Ø­Ø¯Ø«
        function tick(){
          const cd = document.getElementById("schoolCountdown");
          if(!next){ cd.textContent = "â³ â€”"; return; }
          const ms = next.dateObj.getTime() - new Date().getTime();
          cd.textContent = msToCountdown(ms);
        }
        tick();

        // Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„ÙƒÙ„ Ø³Ø·Ø± (Ù„Ù„Ø¬Ù…Ø§Ù„)
        const allCD = [...document.querySelectorAll(".countdown[data-date]")];
        for(const el of allCD){
          const d = parseYMD(el.getAttribute("data-date"));
          const ms = d.getTime() - new Date().getTime();
          el.textContent = msToCountdown(ms);
        }

        // ÙƒÙ„ Ø«Ø§Ù†ÙŠØ© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª
        if(currentView?.countdownId) clearInterval(currentView.countdownId);
        currentView = { key:"school", data: items, countdownId: setInterval(()=>{
          tick();
          const now = new Date().getTime();
          for(const el of allCD){
            const d = parseYMD(el.getAttribute("data-date"));
            el.textContent = msToCountdown(d.getTime() - now);
          }
        }, 1000) };
      }

      sel.addEventListener("change", ()=> paint(sel.value));
      paint("general");
    }

    // =========================
    // Ø´Ø±ÙŠØ· Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© (ØªØ§Ø±ÙŠØ®/ÙˆÙ‚Øª)
    // =========================
    function updateHeader(){
      const now = new Date();
      document.getElementById("hijriText").textContent = `ğŸ“… ${hijriLong(now)}`;
      document.getElementById("gregText").textContent = `ğŸ—“ï¸ ${gregLong(now)}`;
      document.getElementById("clock").textContent = `â° ${timeNow(now)}`;
    }
    updateHeader();
    setInterval(updateHeader, 1000);

    // Ø¥ØºÙ„Ø§Ù‚ Ø¨Ø²Ø± ESC
    document.addEventListener("keydown", (e)=>{
      if(e.key === "Escape") closeSheet();
    });
  </script>
</body>
</html>
