<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†</title>
  <style>
    body{
      font-family: system-ui, -apple-system, Segoe UI, Tahoma, Arial;
      background:#0b1220;
      color:#fff;
      margin:0;
      padding:20px;
      text-align:center;
      display:flex;
      justify-content:center;
    }
    .card{
      width:min(720px, 92vw);
      background:#121b31;
      border-radius:24px;
      padding:26px 18px;
      box-shadow: 0 12px 35px rgba(0,0,0,.35);
    }
    h1{
      margin:0 0 12px;
      font-size:44px;
      letter-spacing:.5px;
    }
    .sub{
      color:#c7d2fe;
      opacity:.9;
      font-size:20px;
      line-height:1.8;
    }
    hr{
      border:none;
      height:1px;
      background:rgba(255,255,255,.12);
      margin:18px 0;
    }

    .section-title{
      font-size:22px;
      color:#dbeafe;
      margin:10px 0 12px;
      opacity:.95;
    }

    .method{
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:center;
      margin:0 0 12px;
    }
    .method-row{
      width:min(520px, 92%);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.08);
      padding:10px 12px;
      border-radius:14px;
    }
    .method-row label{
      display:flex;
      align-items:center;
      gap:10px;
      font-size:18px;
      color:#e5e7eb;
      cursor:pointer;
    }
    .method-row input[type="radio"]{
      transform:scale(1.15);
      cursor:pointer;
    }

    select{
      width:140px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background:#0f172a;
      color:#fff;
      padding:10px 12px;
      font-size:16px;
      outline:none;
    }

    .input{
      width:min(560px, 92%);
      font-size:32px;
      padding:18px 20px;
      border-radius:18px;
      border:none;
      outline:none;
      text-align:right;
      margin:10px auto 12px;
      display:block;
      background:#fff;
      color:#0b1220;
    }
    .btn{
      width:min(560px, 92%);
      font-size:34px;
      padding:18px 20px;
      border-radius:18px;
      border:none;
      cursor:pointer;
      background:#3b66f5;
      color:#fff;
      font-weight:700;
      margin:6px auto 14px;
      display:block;
      box-shadow:0 10px 25px rgba(59,102,245,.25);
    }
    .btn:active{ transform:scale(.99); }

    .result{
      color:#93c5fd;
      font-size:34px;
      line-height:1.65;
      margin-top:8px;
      min-height:120px;
    }
    .result small{
      display:block;
      font-size:18px;
      color:#cbd5e1;
      opacity:.9;
      margin-top:8px;
    }

    .dua-box{
      width:min(560px, 92%);
      margin:18px auto 0;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.1);
      border-radius:18px;
      padding:16px 14px;
      text-align:center;
    }
    .dua-title{
      color:#dbeafe;
      font-size:18px;
      margin-bottom:10px;
      opacity:.9;
    }
    .dua-text{
      color:#fff;
      font-size:22px;
      line-height:1.9;
    }

    .footer{
      margin-top:18px;
      color:#cbd5e1;
      opacity:.85;
      font-size:16px;
    }
  </style>
</head>

<body>
  <div class="card">
    <h1>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù† ğŸ“–</h1>

    <div class="sub" id="hijriDate">...</div>
    <div class="sub" id="timeNow">...</div>

    <hr>

    <div class="section-title">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</div>

    <div class="method">
      <div class="method-row">
        <label>
          <input type="radio" name="mode" value="month" checked>
          Ø­Ø³Ø¨ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù‡Ø¬Ø±ÙŠ (Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ)
        </label>
        <span style="opacity:.75;">ğŸ“…</span>
      </div>

      <div class="method-row">
        <label>
          <input type="radio" name="mode" value="days">
          Ø­Ø³Ø¨ Ù…Ø¯Ø© Ø¨Ø§Ù„Ø£ÙŠØ§Ù…
        </label>
        <select id="daysSelect" disabled>
          <option value="15">15 ÙŠÙˆÙ…</option>
          <option value="30" selected>30 ÙŠÙˆÙ…</option>
          <option value="60">60 ÙŠÙˆÙ…</option>
        </select>
      </div>
    </div>

    <input id="currentPage" class="input" type="number" min="1" max="604" placeholder="Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù„ÙŠ ÙˆØµÙ„Øª Ù„Ù‡Ø§ (1 - 604)">

    <button class="btn" onclick="calculatePlan()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø®Ø·Ø©</button>

    <div class="result" id="result"></div>

    <div class="dua-box">
      <div class="dua-title">Ø¯Ø¹Ø§Ø¡</div>
      <div class="dua-text" id="duaText">...</div>
    </div>

    <hr style="margin-top:18px; opacity:.2;">
    <div class="footer">ğŸ”¥ğŸ’» Ù…Ø¹ ØªØ­ÙŠØ§Øª: Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ Ø±Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø¯Ø¨Ù„Ù‡</div>
  </div>

<script>
  const TOTAL_PAGES = 604;

  // ====== ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©/Ø§Ù„Ù‡Ù†Ø¯ÙŠØ© Ø¥Ù„Ù‰ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© "1 ÙŠÙˆÙ…") ======
  function normalizeDigits(str){
    return String(str)
      .replace(/[Ù -Ù©]/g, d => "0123456789"["Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©".indexOf(d)])
      .replace(/[Û°-Û¹]/g, d => "0123456789"["Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹".indexOf(d)]);
  }

  function getHijriParts(date){
    const parts = new Intl.DateTimeFormat("ar-SA-u-ca-islamic", {
      day: "numeric",
      month: "numeric",
      year: "numeric",
      weekday: "long",
      timeZone: "Asia/Riyadh"
    }).formatToParts(date);

    const getNum = (type) => {
      const p = parts.find(x => x.type === type);
      if (!p) return NaN;
      return parseInt(normalizeDigits(p.value), 10);
    };

    const getText = (type) => (parts.find(x => x.type === type)?.value || "");

    return {
      hDay: getNum("day"),
      hMonth: getNum("month"),
      hYear: getNum("year"),
      weekday: getText("weekday")
    };
  }

  // âœ… ÙŠØ­Ø³Ø¨ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù…Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù‡Ø¬Ø±ÙŠ (Ø´Ø§Ù…Ù„ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ)
  function remainingDaysInHijriMonth(){
    const now = new Date();
    const base = new Date(now);
    base.setHours(12,0,0,0); // ØªØ«Ø¨ÙŠØª Ø§Ù„ÙˆÙ‚Øª Ù„ØªÙØ§Ø¯ÙŠ Ø§Ø®ØªÙ„Ø§ÙØ§Øª Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©

    const startParts = getHijriParts(base);
    const startMonth = startParts.hMonth;

    let remaining = 1; // Ø§Ù„ÙŠÙˆÙ… Ù…Ø­Ø³ÙˆØ¨
    let probe = new Date(base);

    for (let i = 0; i < 40; i++){
      probe.setDate(probe.getDate() + 1);
      const p = getHijriParts(probe);
      if (p.hMonth !== startMonth) break;
      remaining++;
    }

    return { remaining, today: startParts.hDay, month: startParts.hMonth, year: startParts.hYear, weekday: startParts.weekday };
  }

  // ====== Ø¹Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ + Ø§Ù„ÙˆÙ‚Øª (ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ) ======
  function updateDateTime(){
    const now = new Date();

    const hijriText = new Intl.DateTimeFormat("ar-SA-u-ca-islamic", {
      weekday: "long",
      day: "numeric",
      month: "long",
      year: "numeric",
      timeZone: "Asia/Riyadh"
    }).format(now);

    const timeText = new Intl.DateTimeFormat("ar-SA", {
      hour: "numeric",
      minute: "2-digit",
      second: "2-digit",
      hour12: true,
      timeZone: "Asia/Riyadh"
    }).format(now);

    document.getElementById("hijriDate").textContent = "ğŸ“… " + hijriText;
    document.getElementById("timeNow").textContent   = "â° " + timeText;
  }

  // ====== Ø§Ù„Ø£Ø¯Ø¹ÙŠØ© (ØªØªØºÙŠØ± ÙŠÙˆÙ…ÙŠÙ‹Ø§) ======
  const duas = [
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†Ø§ Ù…Ù† Ø£Ù‡Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ø°ÙŠÙ† Ù‡Ù… Ø£Ù‡Ù„Ùƒ ÙˆØ®Ø§ØµØªÙƒØŒ ÙˆØ§Ø±ÙØ¹Ù†Ø§ Ø¨Ù‡ Ø¯Ø±Ø¬Ø§Øª.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†Ø§ ØªØ¯Ø¨Ø± ÙƒØªØ§Ø¨Ùƒ ÙˆØ§Ù„Ø¹Ù…Ù„ Ø¨Ù‡ Ø¢Ù†Ø§Ø¡ Ø§Ù„Ù„ÙŠÙ„ ÙˆØ£Ø·Ø±Ø§Ù Ø§Ù„Ù†Ù‡Ø§Ø±.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø±Ø¨ÙŠØ¹ Ù‚Ù„ÙˆØ¨Ù†Ø§ ÙˆÙ†ÙˆØ± ØµØ¯ÙˆØ±Ù†Ø§ ÙˆØ¬Ù„Ø§Ø¡ Ø£Ø­Ø²Ø§Ù†Ù†Ø§.",
    "Ø§Ù„Ù„Ù‡Ù… Ø¹Ù„Ù‘Ù…Ù†Ø§ Ù…Ù†Ù‡ Ù…Ø§ Ø¬Ù‡Ù„Ù†Ø§ ÙˆØ°ÙƒÙ‘Ø±Ù†Ø§ Ù…Ù†Ù‡ Ù…Ø§ Ù†ÙØ³ÙÙ‘ÙŠÙ†Ø§ ÙˆØ§Ø±Ø²Ù‚Ù†Ø§ ØªÙ„Ø§ÙˆØªÙ‡ Ø­Ù‚ ØªÙ„Ø§ÙˆØªÙ‡.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§ÙƒØªØ¨ Ù„Ù†Ø§ Ø®ØªÙ…Ø©Ù‹ Ù…Ø¨Ø§Ø±ÙƒØ©ØŒ ÙˆØªÙ‚Ø¨Ù„ Ù…Ù†Ø§ ÙˆØ§ØºÙØ± Ù„Ù†Ø§ ÙˆÙ„ÙˆØ§Ù„Ø¯ÙŠÙ†Ø§ ÙˆÙ„Ù„Ù…Ø³Ù„Ù…ÙŠÙ†.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ù…Ø§ Ù†Ù‚Ø±Ø£Ù‡ Ø­Ø¬Ø©Ù‹ Ù„Ù†Ø§ Ù„Ø§ Ø¹Ù„ÙŠÙ†Ø§ØŒ ÙˆØ§Ù‡Ø¯ÙÙ†Ø§ Ø¨Ù‡ Ø¥Ù„Ù‰ ØµØ±Ø§Ø·Ùƒ Ø§Ù„Ù…Ø³ØªÙ‚ÙŠÙ….",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø´ÙÙ ØµØ¯ÙˆØ±Ù†Ø§ Ø¨Ø§Ù„Ù‚Ø±Ø¢Ù†ØŒ ÙˆØ¨Ø¯Ù‘Ù„ Ù‡Ù…Ù‘Ù†Ø§ ÙØ±Ø­Ù‹Ø§ ÙˆØ¶ÙŠÙ‘Ù‚Ù†Ø§ ÙØ±Ø¬Ù‹Ø§.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†Ø§ Ù…Ù…Ù† ÙŠÙ‚ÙŠÙ…ÙˆÙ† Ø­Ø¯ÙˆØ¯Ù‡ ÙˆÙŠØ¹Ù…Ù„ÙˆÙ† Ø¨Ù…Ø­ÙƒÙ…Ù‡ ÙˆÙŠØ¤Ù…Ù†ÙˆÙ† Ø¨Ù…ØªØ´Ø§Ø¨Ù‡Ù‡.",
    "Ø§Ù„Ù„Ù‡Ù… Ø¨Ø§Ø±Ùƒ Ù„Ù†Ø§ ÙÙŠ Ø£ÙˆÙ‚Ø§ØªÙ†Ø§ ÙˆØ£Ø¹Ù…Ø§Ù„Ù†Ø§ ÙˆØ§Ø¬Ø¹Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø£Ù†ÙŠØ³Ù†Ø§ ÙÙŠ Ø§Ù„Ø¯Ù†ÙŠØ§ ÙˆØ§Ù„Ø¢Ø®Ø±Ø©.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†Ø§ Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±ÙŠÙ† Ø§Ù„Ø´Ø§ÙƒØ±ÙŠÙ†ØŒ ÙˆØ§Ø¬Ø¹Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø³Ø¨Ø¨Ù‹Ø§ Ù„Ø±Ø¶Ø§Ùƒ Ø¹Ù†Ø§."
  ];

  function setDailyDua(){
    const now = new Date();
    const key = now.getFullYear() + "-" + (now.getMonth()+1) + "-" + now.getDate();
    let hash = 0;
    for (let i=0;i<key.length;i++) hash = (hash*31 + key.charCodeAt(i)) >>> 0;
    const idx = hash % duas.length;
    document.getElementById("duaText").textContent = duas[idx];
  }

  // ====== Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ======
  function calculatePlan(){
    const pageValRaw = document.getElementById("currentPage").value;
    const current = parseInt(pageValRaw, 10);

    if (isNaN(current) || current < 1 || current > TOTAL_PAGES){
      document.getElementById("result").innerHTML = "âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ØµÙØ­Ø© ØµØ­ÙŠØ­ Ø¨ÙŠÙ† 1 Ùˆ 604";
      return;
    }

    const remainingPages = TOTAL_PAGES - current;

    const mode = document.querySelector('input[name="mode"]:checked').value;

    let days = 0;
    if (mode === "month"){
      const info = remainingDaysInHijriMonth();
      days = info.remaining;
    } else {
      days = parseInt(document.getElementById("daysSelect").value, 10);
    }

    if (!days || days <= 0){
      document.getElementById("result").innerHTML = "âš ï¸ ØªØ¹Ø°Ø± Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£ÙŠØ§Ù…";
      return;
    }

    const pagesPerDay = Math.ceil(remainingPages / days);

    document.getElementById("result").innerHTML =
      `ğŸ“˜ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${remainingPages}<br>` +
      `ğŸ“… Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…: ${days}<br>` +
      `ğŸ“– Ø§Ù‚Ø±Ø£ ÙŠÙˆÙ…ÙŠÙ‹Ø§: ${pagesPerDay} ØµÙØ­Ø©<br>` +
      `âœ… Ù„ØªØ®ØªÙ… Ù‚Ø¨Ù„ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø¯Ø©` +
      `<small>Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø­Ø³Ø§Ø¨ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª/Ø§Ù„ØªØ§Ø±ÙŠØ® ÙÙŠ Ø¬Ù‡Ø§Ø²Ùƒ (ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø±ÙŠØ§Ø¶).</small>`;
  }

  // ====== ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£ÙŠØ§Ù… ======
  function setupModeToggle(){
    const radios = document.querySelectorAll('input[name="mode"]');
    const daysSelect = document.getElementById("daysSelect");

    function refresh(){
      const mode = document.querySelector('input[name="mode"]:checked').value;
      daysSelect.disabled = (mode !== "days");
    }

    radios.forEach(r => r.addEventListener("change", refresh));
    refresh();
  }

  // ====== ØªØ´ØºÙŠÙ„ ======
  updateDateTime();
  setDailyDua();
  setupModeToggle();

  setInterval(updateDateTime, 1000);

  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø¹Ø§Ø¡ Ø¥Ø°Ø§ ØªØºÙŠÙ‘Ø± Ø§Ù„ÙŠÙˆÙ… (ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø© ÙŠÙƒÙÙŠ)
  setInterval(() => {
    setDailyDua();
  }, 60000);
</script>
</body>
</html>
