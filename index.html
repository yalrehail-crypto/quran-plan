<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†</title>

  <style>
    :root{
      --bg:#0b1220;
      --card:#121b31;
      --card2:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.12);
      --text:#ffffff;
      --muted:rgba(255,255,255,.70);
      --muted2:rgba(255,255,255,.55);
      --accent:#4f6df5;
      --accent2:#3f60ff;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Tahoma, Arial;
      background: radial-gradient(1200px 800px at 50% 10%, rgba(79,109,245,.25), transparent 60%),
                  radial-gradient(900px 700px at 20% 70%, rgba(79,109,245,.12), transparent 60%),
                  var(--bg);
      color:var(--text);
      display:flex;
      justify-content:center;
      padding:24px 14px;
    }

    .wrap{
      width:min(720px, 100%);
    }

    .mainCard{
      background: linear-gradient(180deg, rgba(18,27,49,.98), rgba(18,27,49,.92));
      border:1px solid rgba(255,255,255,.10);
      border-radius:26px;
      padding:26px 18px 18px;
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
    }

    h1{
      margin:0;
      font-size:44px;
      letter-spacing: .5px;
      text-align:center;
      line-height:1.2;
    }

    .subline{
      margin-top:10px;
      text-align:center;
      color:var(--muted);
      font-size:20px;
    }

    .timeLine{
      margin-top:8px;
      text-align:center;
      color:rgba(255,255,255,.78);
      font-size:22px;
    }

    hr.sep{
      margin:18px 0;
      border:none;
      height:1px;
      background: rgba(255,255,255,.12);
    }

    /* ====== Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ (ØªØµÙ…ÙŠÙ… Ø£Ù†ÙŠÙ‚) ====== */
    .modeTitle{
      margin: 0 0 12px;
      font-size: 20px;
      color: #cfe0ff;
      text-align:center;
    }

    .modeWrap{
      display:grid;
      gap:12px;
      margin: 12px 0 14px;
    }

    .modeCard{
      display:grid;
      grid-template-columns: 1fr auto;
      align-items:center;
      gap:12px;
      background: var(--card2);
      border:1px solid var(--border);
      border-radius:18px;
      padding:14px 14px;
    }

    .modeCard .label{
      font-size:18px;
      color:#e9f0ff;
      line-height:1.4;
    }
    .modeCard .sub{
      font-size:14px;
      color:var(--muted2);
      margin-top:4px;
    }

    .modeCard input[type="radio"]{
      width:22px;
      height:22px;
      accent-color: var(--accent);
    }

    .daysRow{
      margin-top:10px;
      display:flex;
      gap:10px;
      align-items:center;
    }

    select{
      width: 180px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.10);
      color:#fff;
      font-size:18px;
      outline:none;
    }

    .input{
      width:100%;
      margin-top:10px;
      background:#fff;
      color:#111;
      border:none;
      border-radius:18px;
      padding:18px 18px;
      font-size:26px;
      text-align:right;
      outline:none;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.06);
    }
    .input::placeholder{color:#8a8a8a}

    .btn{
      width:100%;
      margin-top:14px;
      border:none;
      border-radius:22px;
      padding:18px 18px;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      color:#fff;
      font-size:34px;
      font-weight:800;
      cursor:pointer;
      box-shadow: 0 14px 30px rgba(79,109,245,.30);
    }
    .btn:active{transform: translateY(1px);}

    .result{
      margin-top:16px;
      text-align:center;
      color:#9fc2ff;
      font-size:34px;
      line-height:1.6;
      white-space:pre-line;
    }

    .hint{
      margin-top:12px;
      color: rgba(255,255,255,.55);
      text-align:center;
      font-size:16px;
    }

    .smallCard{
      margin-top:16px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      border-radius:18px;
      padding:16px 14px;
      text-align:center;
    }

    .smallCard .title{
      font-size:22px;
      color:#e9f0ff;
      margin-bottom:10px;
    }
    .smallCard .content{
      font-size:22px;
      color:rgba(255,255,255,.86);
      line-height:1.8;
    }

    /* ÙŠÙˆØªÙŠÙˆØ¨ */
    .ytWrap{
      margin-top:14px;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.25);
    }
    .ytWrap iframe{
      width:100%;
      aspect-ratio: 16/9;
      display:block;
      border:0;
    }

    .footer{
      margin-top:18px;
      text-align:center;
      color: rgba(255,255,255,.55);
      font-size:16px;
      padding-top:12px;
      border-top:1px solid rgba(255,255,255,.10);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="mainCard">

      <h1>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù† ğŸ“–</h1>

      <div class="subline" id="hijriDateLine">...</div>
      <div class="timeLine" id="timeLine">...</div>

      <hr class="sep"/>

      <h3 class="modeTitle">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</h3>

      <div class="modeWrap">
        <label class="modeCard">
          <div>
            <div class="label">ğŸ“… Ø­Ø³Ø¨ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù‡Ø¬Ø±ÙŠ (Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ)</div>
            <div class="sub">ÙŠØ­Ø³Ø¨ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù…Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§</div>
          </div>
          <input type="radio" name="mode" value="month" checked>
        </label>

        <label class="modeCard">
          <div>
            <div class="label">â³ Ø­Ø³Ø¨ Ù…Ø¯Ø© Ø¨Ø§Ù„Ø£ÙŠØ§Ù…</div>
            <div class="sub">Ø§Ø®ØªØ± 15 Ø£Ùˆ 30 Ø£Ùˆ 60 ÙŠÙˆÙ…</div>
            <div class="daysRow">
              <select id="daysSelect">
                <option value="60">60 ÙŠÙˆÙ…</option>
                <option value="30" selected>30 ÙŠÙˆÙ…</option>
                <option value="15">15 ÙŠÙˆÙ…</option>
              </select>
            </div>
          </div>
          <input type="radio" name="mode" value="days">
        </label>
      </div>

      <input id="currentPage" class="input" type="number" min="1" max="604" placeholder="Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù„ÙŠ ÙˆØµÙ„Øª Ù„Ù‡Ø§" />

      <button class="btn" id="calcBtn">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø®Ø·Ø©</button>

      <div class="result" id="result"></div>

      <div class="hint">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø­Ø³Ø§Ø¨ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ØªØ§Ø±ÙŠØ®/Ø§Ù„ÙˆÙ‚Øª ÙÙŠ Ø¬Ù‡Ø§Ø²Ùƒ.</div>

      <!-- Ø¯Ø¹Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… -->
      <div class="smallCard" id="duaCard">
        <div class="title">Ø¯Ø¹Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…</div>
        <div class="content" id="duaText">...</div>
      </div>

      <!-- ÙŠÙˆØªÙŠÙˆØ¨ ØªØ­Øª Ø§Ù„Ø¯Ø¹Ø§Ø¡ -->
      <div class="smallCard" style="margin-top:14px;">
        <div class="title">Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ğŸ“º</div>
        <div class="ytWrap">
          <iframe
            src="https://www.youtube.com/embed/Cm1v4bteXbI?rel=0&modestbranding=1"
            title="YouTube live"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen>
          </iframe>
        </div>
      </div>

      <div class="footer">Ù…Ø¹ ØªØ­ÙŠØ§Øª :Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ Ø±Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø¯Ø¨Ù„Ù‡ ğŸ”¥ğŸ’»</div>
    </div>
  </div>

  <script>
    const TOTAL_PAGES = 604;

    // ====== Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ ======
    function getHijriParts(date){
      // Ø§Ù„ØªÙ‚ÙˆÙŠÙ…: islamic-umalqura
      const fmt = new Intl.DateTimeFormat('ar-SA-u-ca-islamic-umalqura', {
        weekday:'long', day:'numeric', month:'long', year:'numeric'
      });
      const parts = fmt.formatToParts(date);
      const get = (type) => (parts.find(p => p.type === type)?.value || '');
      return {
        weekday: get('weekday'),
        day: parseInt(get('day'), 10),
        month: get('month'),
        year: get('year'),
        raw: fmt.format(date)
      };
    }

    // Ù†Ø­Ø³Ø¨ Ø·ÙˆÙ„ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù‡Ø¬Ø±ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¶Ù…ÙˆÙ†Ø©:
    // Ù†Ù…Ø´ÙŠ Ù„Ù„Ø£Ù…Ø§Ù… ÙŠÙˆÙ… ÙŠÙˆÙ… Ù„ÙŠÙ† ÙŠØªØºÙŠØ± Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù‡Ø¬Ø±ÙŠØŒ ÙˆÙ†Ø¹Ø¯ Ø§Ù„Ø£ÙŠØ§Ù….
    function getHijriMonthLength(today){
      const p0 = getHijriParts(today);
      let count = 0;
      let d = new Date(today);
      for(let i=0;i<40;i++){ // 40 ÙƒÙØ§ÙŠØ© Ù„Ø£ÙŠ Ø´Ù‡Ø±
        const p = getHijriParts(d);
        if(p.month !== p0.month || p.year !== p0.year) break;
        count++;
        d.setDate(d.getDate()+1);
      }
      return count; // Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø´Ù‡Ø±
    }

    function getDaysRemainingInHijriMonthInclusive(today){
      const p = getHijriParts(today);
      const monthLen = getHijriMonthLength(today);
      if(!Number.isFinite(p.day) || !Number.isFinite(monthLen)) return null;
      // Ø´Ø§Ù…Ù„ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
      return Math.max(1, (monthLen - p.day + 1));
    }

    function updateDateTime(){
      const now = new Date();

      // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ ÙÙŠ Ø³Ø·Ø± ÙˆØ§Ø­Ø¯
      const hijri = getHijriParts(now);
      document.getElementById('hijriDateLine').textContent =
        `${hijri.weekday}ØŒ ${hijri.day} ${hijri.month}ØŒ ${hijri.year} Ù‡Ù€`;

      // Ø§Ù„ÙˆÙ‚Øª
      const timeFmt = new Intl.DateTimeFormat('ar-SA', {
        hour:'numeric', minute:'2-digit', second:'2-digit'
      });
      document.getElementById('timeLine').textContent = timeFmt.format(now);
    }

    // ====== Ø¯Ø¹Ø§Ø¡ ÙŠÙˆÙ…ÙŠ (ÙŠØªØºÙŠØ± ÙƒÙ„ ÙŠÙˆÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§) ======
    const DUAS = [
      "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†Ø§ Ù…Ù† Ø£Ù‡Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ø°ÙŠÙ† Ù‡Ù… Ø£Ù‡Ù„Ùƒ ÙˆØ®Ø§ØµØªÙƒØŒ ÙˆØ§Ø±ÙØ¹Ù†Ø§ Ø¨Ù‡ Ø¯Ø±Ø¬Ø§Øª.",
      "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø±Ø¨ÙŠØ¹ Ù‚Ù„ÙˆØ¨Ù†Ø§ ÙˆÙ†ÙˆØ± ØµØ¯ÙˆØ±Ù†Ø§ ÙˆØ¬Ù„Ø§Ø¡ Ø£Ø­Ø²Ø§Ù†Ù†Ø§.",
      "Ø§Ù„Ù„Ù‡Ù… Ø£Ø¹Ù†Ù‘Ø§ Ø¹Ù„Ù‰ Ø°ÙƒØ±Ùƒ ÙˆØ´ÙƒØ±Ùƒ ÙˆØ­Ø³Ù† Ø¹Ø¨Ø§Ø¯ØªÙƒ.",
      "Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†Ø§ Ø§Ù„Ø¥Ø®Ù„Ø§Øµ ÙÙŠ Ø§Ù„Ù‚ÙˆÙ„ ÙˆØ§Ù„Ø¹Ù…Ù„ØŒ ÙˆØ¨Ø§Ø±Ùƒ Ù„Ù†Ø§ ÙÙŠ Ø£ÙˆÙ‚Ø§ØªÙ†Ø§.",
      "Ø§Ù„Ù„Ù‡Ù… Ø§ØºÙØ± Ù„Ù†Ø§ ÙˆÙ„ÙˆØ§Ù„Ø¯ÙŠÙ†Ø§ ÙˆÙ„Ù„Ù…Ø³Ù„Ù…ÙŠÙ† ÙˆØ§Ù„Ù…Ø³Ù„Ù…Ø§Øª Ø§Ù„Ø£Ø­ÙŠØ§Ø¡ Ù…Ù†Ù‡Ù… ÙˆØ§Ù„Ø£Ù…ÙˆØ§Øª.",
      "Ø§Ù„Ù„Ù‡Ù… Ø«Ø¨ØªÙ†Ø§ Ø¹Ù„Ù‰ Ø·Ø§Ø¹ØªÙƒ ÙˆØ§Ø¬Ø¹Ù„ Ø®ÙŠØ± Ø£Ø¹Ù…Ø§Ù„Ù†Ø§ Ø®ÙˆØ§ØªÙŠÙ…Ù‡Ø§.",
      "Ø§Ù„Ù„Ù‡Ù… Ø§ÙØªØ­ Ù„Ù†Ø§ Ø£Ø¨ÙˆØ§Ø¨ Ø±Ø­Ù…ØªÙƒØŒ ÙˆÙŠØ³Ù‘Ø± Ù„Ù†Ø§ Ø£Ù…ÙˆØ±Ù†Ø§ ÙƒÙ„Ù‡Ø§."
    ];

    function dailyKey(date){
      // Ù…ÙØªØ§Ø­ ÙŠÙˆÙ…ÙŠ Ø­Ø³Ø¨ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¬Ù‡Ø§Ø² (YYYY-MM-DD)
      const y = date.getFullYear();
      const m = String(date.getMonth()+1).padStart(2,'0');
      const d = String(date.getDate()).padStart(2,'0');
      return `${y}-${m}-${d}`;
    }

    function updateDailyDua(){
      const key = dailyKey(new Date());
      const savedKey = localStorage.getItem('dua_key');
      let idx = parseInt(localStorage.getItem('dua_idx') || '-1', 10);

      if(savedKey !== key || !Number.isFinite(idx) || idx < 0){
        // Ø§Ø®ØªÙŠØ§Ø± Ø«Ø§Ø¨Øª Ù„Ù„ÙŠÙˆÙ… (Ø¨Ø¯ÙˆÙ† Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù…Ø²Ø¹Ø¬Ø©): Ù†Ø­ÙˆÙ„ key Ù„Ø±Ù‚Ù… Ø¨Ø³ÙŠØ·
        let sum = 0;
        for (const ch of key) sum += ch.charCodeAt(0);
        idx = sum % DUAS.length;

        localStorage.setItem('dua_key', key);
        localStorage.setItem('dua_idx', String(idx));
      }

      document.getElementById('duaText').textContent = DUAS[idx];
    }

    // ====== UI Ø§Ù„Ù…Ø¯Ø© ======
    function refreshModeUI(){
      const mode = document.querySelector('input[name="mode"]:checked').value;
      document.getElementById('daysSelect').disabled = (mode !== 'days');
    }
    document.querySelectorAll('input[name="mode"]').forEach(r=>{
      r.addEventListener('change', refreshModeUI);
    });

    // ====== Ø§Ù„Ø­Ø³Ø§Ø¨ ======
    function calculatePlan(){
      const mode = document.querySelector('input[name="mode"]:checked').value;

      const current = parseInt(document.getElementById('currentPage').value, 10);

      if(!Number.isFinite(current) || current < 1 || current > TOTAL_PAGES){
        document.getElementById('result').textContent = `âš ï¸ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… ØµÙØ­Ø© ØµØ­ÙŠØ­ Ø¨ÙŠÙ† 1 Ùˆ ${TOTAL_PAGES}`;
        return;
      }

      const remainingPages = Math.max(0, TOTAL_PAGES - current);

      let days = null;
      let daysLabel = "";

      if(mode === 'days'){
        days = parseInt(document.getElementById('daysSelect').value, 10);
        daysLabel = `Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…: ${days}`;
      }else{
        const rem = getDaysRemainingInHijriMonthInclusive(new Date());
        if(rem == null){
          document.getElementById('result').textContent = `âš ï¸ ØªØ¹Ø°Ø± Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù…Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù‡Ø¬Ø±ÙŠ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø².`;
          return;
        }
        days = rem;
        daysLabel = `Ø£ÙŠØ§Ù… Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© (Ù‡Ø¬Ø±ÙŠ): ${days}`;
      }

      if(remainingPages === 0){
        document.getElementById('result').textContent =
          `ğŸ“˜ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: 0\nğŸ“– Ù…Ø§ Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡! Ø£Ù†Øª Ø®ØªÙ…Øª Ø§Ù„Ù‚Ø±Ø¢Ù† âœ…`;
        return;
      }

      // ØµÙØ­Ø§Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§
      const perDay = Math.ceil(remainingPages / days);

      document.getElementById('result').textContent =
        `ğŸ“˜ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${remainingPages}\nğŸ—“ï¸ ${daysLabel}\nğŸ“– Ø§Ù‚Ø±Ø£ ÙŠÙˆÙ…ÙŠÙ‹Ø§: ${perDay} ØµÙØ­Ø©\nâœ… Ù„ØªØ®ØªÙ… Ù‚Ø¨Ù„ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø¯Ø©`;
    }

    // Ø²Ø± + Enter
    document.getElementById('calcBtn').addEventListener('click', calculatePlan);
    document.getElementById('currentPage').addEventListener('keydown', (e)=>{
      if(e.key === 'Enter') calculatePlan();
    });

    // ØªØ´ØºÙŠÙ„
    refreshModeUI();
    updateDateTime();
    updateDailyDua();
    setInterval(updateDateTime, 1000);

    // Ù„Ùˆ ØªØºÙŠØ± Ø§Ù„ÙŠÙˆÙ…ØŒ Ø­Ø¯Ù‘Ø« Ø§Ù„Ø¯Ø¹Ø§Ø¡ (Ù†ÙØ­Øµ ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©)
    setInterval(updateDailyDua, 60 * 1000);
  </script>
</body>
</html>
