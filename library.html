<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù…ÙƒØªØ¨ØªÙŠ</title>

  <style>
    :root{
      --bg:#081426;
      --card:#0f2140cc;
      --card2:#0c1b34cc;
      --text:#ffffff;
      --muted:#b9c6df;
      --muted2:#93a4c6;
      --accent:#3f66ff;
      --accent2:#2b4dd6;
      --shadow: 0 20px 50px rgba(0,0,0,.35);
      --radius: 26px;
      --line: rgba(255,255,255,.10);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 50% -200px, #143261 0%, var(--bg) 55%, #050b14 100%);
      color:var(--text);
      min-height:100vh;
      padding:24px 14px 70px;
    }

    .wrap{ width:min(980px, 100%); margin:0 auto; }

    .card{
      background: linear-gradient(180deg, rgba(14,33,70,.95), rgba(10,22,45,.92));
      border: 1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 22px 16px 18px;
      overflow:hidden;
    }

    .topBar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    .title{
      font-weight: 950;
      font-size: clamp(26px, 4.5vw, 44px);
      margin:0;
      letter-spacing:.3px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .title .emoji{ font-size:.9em; }

    .nav{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-start;
    }
    .nav a{
      text-decoration:none;
      color:var(--text);
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      padding:12px 14px;
      border-radius: 18px;
      font-weight: 900;
      font-size: 16px;
    }
    .nav a.active{
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      border-color: transparent;
      box-shadow: 0 14px 35px rgba(63,102,255,.30);
    }

    hr.sep{
      border:none;
      height:1px;
      background: rgba(255,255,255,.12);
      margin: 16px 0 16px;
    }

    .searchRow{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .search{
      flex:1;
      display:flex;
      align-items:center;
      gap:10px;
      background: rgba(255,255,255,.92);
      border-radius: 22px;
      padding: 14px 14px;
      border: 1px solid rgba(0,0,0,.06);
      box-shadow: inset 0 2px 0 rgba(0,0,0,.05);
    }
    .search input{
      border:none;
      outline:none;
      background: transparent;
      width:100%;
      font-size: 18px;
      font-weight: 800;
      color:#0b1220;
      text-align:right;
    }
    .searchIcon{
      width:34px;
      height:34px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      background: rgba(15,33,64,.10);
      color:#0b1220;
      font-weight:900;
      flex:0 0 auto;
    }

    .hint{
      margin-top: 10px;
      color: rgba(255,255,255,.60);
      font-size: 14px;
      font-weight: 700;
    }

    .catsTitleRow{
      margin-top: 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    .catsTitle{
      margin:0;
      font-size: 20px;
      font-weight: 950;
      color:#e9f1ff;
    }
    .smallMuted{
      color: rgba(255,255,255,.55);
      font-size: 13px;
      font-weight: 700;
    }

    .catsGrid{
      margin-top: 12px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 10px;
    }

    .catBtn{
      border:none;
      cursor:pointer;
      text-align:right;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      padding: 14px 14px;
      border-radius: 18px;
      color:var(--text);
      font-weight: 950;
      font-size: 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      transition: transform .06s ease;
    }
    .catBtn:active{ transform: scale(.99); }
    .catBtn.active{
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      border-color: transparent;
      box-shadow: 0 14px 35px rgba(63,102,255,.30);
    }
    .catLeft{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .catEmoji{ font-size: 20px; }
    .catName{
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .catCount{
      opacity:.75;
      font-weight: 900;
      font-size: 13px;
      flex: 0 0 auto;
      background: rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.10);
      padding: 6px 10px;
      border-radius: 999px;
    }
    .catBtn.active .catCount{
      background: rgba(255,255,255,.18);
    }

    .booksHeader{
      margin-top: 18px;
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap: 12px;
      flex-wrap:wrap;
    }
    .booksHeader h2{
      margin:0;
      font-size: 26px;
      font-weight: 950;
    }
    .booksHeader .sub{
      margin:0;
      color: rgba(255,255,255,.60);
      font-weight: 700;
      font-size: 14px;
      line-height:1.6;
    }

    .booksGrid{
      margin-top: 14px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 12px;
    }

    .bookCard{
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 22px;
      overflow:hidden;
      box-shadow: 0 16px 40px rgba(0,0,0,.18);
    }

    .cover{
      aspect-ratio: 4 / 3;
      background: radial-gradient(600px 220px at 50% 0%, rgba(63,102,255,.20), rgba(255,255,255,.02));
      border-bottom: 1px solid rgba(255,255,255,.08);
      display:grid;
      place-items:center;
      padding: 10px;
    }
    .cover img{
      max-width: 100%;
      max-height: 100%;
      border-radius: 14px;
      object-fit: cover;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.12);
    }

    .bookBody{
      padding: 12px 12px 14px;
      text-align:right;
    }
    .bookTitle{
      margin:0;
      font-size: 18px;
      font-weight: 950;
      color:#f0f6ff;
      line-height: 1.5;
    }
    .bookAuthor{
      margin: 6px 0 0;
      color: rgba(255,255,255,.65);
      font-weight: 800;
      font-size: 14px;
    }

    .bookMeta{
      margin-top: 10px;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }
    .tag{
      font-size: 12px;
      font-weight: 900;
      color: rgba(255,255,255,.85);
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      padding: 6px 10px;
      border-radius: 999px;
    }

    .btnRow{
      margin-top: 12px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:flex-start;
      flex-wrap:wrap;
    }
    .btn{
      border:none;
      cursor:pointer;
      padding: 12px 14px;
      border-radius: 16px;
      font-weight: 950;
      font-size: 15px;
      color:#fff;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      box-shadow: 0 14px 35px rgba(63,102,255,.28);
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap: 8px;
    }
    .btn.secondary{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      box-shadow:none;
    }

    .empty{
      margin-top: 14px;
      background: rgba(255,255,255,.04);
      border:1px dashed rgba(255,255,255,.16);
      padding: 18px 14px;
      border-radius: 22px;
      color: rgba(255,255,255,.70);
      font-weight: 800;
      line-height: 1.9;
      text-align:center;
    }

    .footer{
      margin-top: 16px;
      text-align:center;
      color: rgba(255,255,255,.55);
      font-size: 14px;
      font-weight: 700;
    }

    @media (min-width: 820px){
      .catsGrid{ grid-template-columns: repeat(3, minmax(0,1fr)); }
      .booksGrid{ grid-template-columns: repeat(3, minmax(0,1fr)); }
    }

    @media (max-width: 420px){
      .nav a{ font-size:15px; padding: 11px 12px; }
      .booksGrid{ grid-template-columns: 1fr; }
      .catsGrid{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">

      <div class="topBar">
        <h1 class="title"><span class="emoji">ğŸ“š</span> Ù…ÙƒØªØ¨ØªÙŠ</h1>

        <!-- ØªÙ†Ù‚Ù‘Ù„ Ø¨ÙŠÙ† ØµÙØ­Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ -->
        <div class="nav">
          <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
          <a href="quran.html">Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†</a>
          <a href="calendar.html">ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</a>
          <a class="active" href="library.html">Ù…ÙƒØªØ¨ØªÙŠ</a>
        </div>
      </div>

      <hr class="sep">

      <div class="searchRow">
        <div class="search">
          <div class="searchIcon">ğŸ”</div>
          <input id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙƒØªØ§Ø¨ (Ø¹Ù†ÙˆØ§Ù†/Ù…Ø¤Ù„Ù)..." />
        </div>
      </div>
      <div class="hint">ğŸ’¡ ØªÙ‚Ø¯Ø± ØªØ¨Ø­Ø« Ø¨Ø£ÙŠ ÙƒÙ„Ù…Ø©â€¦ ÙˆØ§Ù„ÙƒØªØ¨ ØªØªÙÙ„ØªØ± Ù…Ø¨Ø§Ø´Ø±Ø©.</div>

      <div class="catsTitleRow">
        <h2 class="catsTitle">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h2>
        <div class="smallMuted" id="countsText">â€”</div>
      </div>

      <div class="catsGrid" id="catsGrid"></div>

      <div class="booksHeader">
        <div>
          <h2 id="booksTitle">Ø§Ù„ÙƒØªØ¨</h2>
          <p class="sub" id="booksSub">Ø§Ø®ØªØ± Ù‚Ø³Ù… Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙƒØªØ¨.</p>
        </div>
      </div>

      <div class="booksGrid" id="booksGrid"></div>
      <div class="empty" id="emptyBox" style="display:none;"></div>

      <div class="footer">Ù…Ø¹ ØªØ­ÙŠØ§Øª: Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ Ø±Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø¯Ø¨Ù„Ù‡ ğŸ”¥ğŸ’»</div>
    </div>
  </div>

  <script>
    /**
     * âœ… ÙƒÙŠÙ ØªØ¶ÙŠÙ ÙƒØªØ¨ØŸ
     * 1) Ø£Ù†Ø´Ø¦ Ù…Ø¬Ù„Ø¯ Ø¯Ø§Ø®Ù„ Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ø³Ù…Ù‡: pdfs
     * 2) Ø§Ø±ÙØ¹ Ù…Ù„ÙØ§Øª PDF Ø¯Ø§Ø®Ù„Ù‡
     * 3) Ø¹Ø¯Ù‘Ù„ Ù‚ÙŠÙ…Ø© pdf ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ØªØ­Øª Ù„ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ù…Ø³Ø§Ø±:
     *    Ù…Ø«Ø§Ù„: "pdfs/riyad-alsalihin.pdf"
     *
     * âœ… ÙƒÙŠÙ ØªØ¶ÙŠÙ ØºÙ„Ø§ÙØŸ
     * - Ø­Ø· ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ù…Ø¬Ù„Ø¯: covers
     * - Ø«Ù…: cover: "covers/book.jpg"
     */

    const CATEGORIES = [
      { id:"follow",   name:"ØªØ§Ø¨Ø¹Ù†ÙŠ", emoji:"ğŸ””" },
      { id:"ads",      name:"Ø£Ø¹Ù„Ù† Ù„Ø¯ÙŠÙ†Ø§", emoji:"ğŸ›ï¸" },
      { id:"variety",  name:"Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ù†ÙˆØ¹Ø§Øª", emoji:"ğŸ’›" },
      { id:"stories",  name:"Ø§Ù„Ø±ÙˆØ§ÙŠØ§Øª ÙˆØ§Ù„Ù‚ØµØµ", emoji:"ğŸ“š" },
      { id:"lit",      name:"Ø§Ù„Ø£Ø¯Ø¨ ÙˆØ§Ù„Ø´Ø¹Ø±", emoji:"ğŸ“œ" },
      { id:"islamic",  name:"Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©", emoji:"ğŸ•‹" },
      { id:"philo",    name:"Ø§Ù„ÙÙƒØ± ÙˆØ§Ù„ÙÙ„Ø³ÙØ©", emoji:"ğŸ§ " },
      { id:"soc",      name:"Ø¹Ù„Ù… Ø§Ù„Ù†ÙØ³ ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹", emoji:"ğŸ‘¥" },
      { id:"biz",      name:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„", emoji:"ğŸ“˜" },
      { id:"dev",      name:"Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø¨Ø´Ø±ÙŠØ©", emoji:"ğŸ“Š" },
      { id:"eng",      name:"Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©", emoji:"âš™ï¸" },
      { id:"med",      name:"Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø·Ø¨ÙŠØ©", emoji:"ğŸ«€" },
      { id:"science",  name:"Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø¹Ù„Ù…ÙŠØ©", emoji:"ğŸ§¬" },
      { id:"tech",     name:"Ø§Ù„ØªÙ‚Ù†ÙŠØ© ÙˆØ§Ù„Ø¨Ø±Ù…Ø¬Ø©", emoji:"ğŸ’»" },
    ];

    // â¬‡ï¸ ÙƒØªØ¨ ØªØ¬Ø±ÙŠØ¨ÙŠØ© (ØºÙŠÙ‘Ø±Ù‡Ø§ Ø­Ø³Ø¨ Ù…Ù„ÙØ§ØªÙƒ)
    // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ù‡ Ù…Ø¬Ø±Ø¯ Ø£Ù…Ø«Ù„Ø©ØŒ Ù„Ø§Ø²Ù… ØªØ±ÙØ¹ Ù…Ù„ÙØ§ØªÙƒ Ø£Ù†Øª Ø¯Ø§Ø®Ù„ pdfs/
    const BOOKS = [
      { id:1,  cat:"islamic", title:"Ø±ÙŠØ§Ø¶ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†", author:"Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ù†ÙˆÙˆÙŠ", pdf:"pdfs/riyad-alsalihin.pdf", cover:"covers/riyad.jpg", tags:["Ø¥Ø³Ù„Ø§Ù…ÙŠ","Ø­Ø¯ÙŠØ«"] },
      { id:2,  cat:"stories", title:"Ø±ÙˆØ§ÙŠØ© ØªØ¬Ø±ÙŠØ¨ÙŠØ©", author:"â€”", pdf:"pdfs/story-sample.pdf", cover:"covers/story.jpg", tags:["Ø±ÙˆØ§ÙŠØ§Øª"] },
      { id:3,  cat:"lit",     title:"Ø¯ÙŠÙˆØ§Ù† ØªØ¬Ø±ÙŠØ¨ÙŠ", author:"â€”", pdf:"pdfs/diwan-sample.pdf", cover:"covers/poem.jpg", tags:["Ø´Ø¹Ø±"] },
      { id:4,  cat:"philo",   title:"Ù…Ø¯Ø®Ù„ Ù„Ù„ÙÙ„Ø³ÙØ© (Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ)", author:"â€”", pdf:"pdfs/philo-sample.pdf", cover:"covers/philo.jpg", tags:["ÙÙ„Ø³ÙØ©"] },
      { id:5,  cat:"biz",     title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª (Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ)", author:"â€”", pdf:"pdfs/time-management.pdf", cover:"covers/biz.jpg", tags:["Ø¥Ø¯Ø§Ø±Ø©","ØªØ·ÙˆÙŠØ±"] },
      { id:6,  cat:"tech",    title:"Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© (Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ)", author:"â€”", pdf:"pdfs/programming.pdf", cover:"covers/tech.jpg", tags:["Ø¨Ø±Ù…Ø¬Ø©"] },
      { id:7,  cat:"science", title:"Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ø¹Ù„ÙˆÙ… (Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ)", author:"â€”", pdf:"pdfs/science.pdf", cover:"covers/science.jpg", tags:["Ø¹Ù„ÙˆÙ…"] },
      { id:8,  cat:"med",     title:"Ù…Ø¨Ø§Ø¯Ø¦ ØµØ­ÙŠØ© (Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ)", author:"â€”", pdf:"pdfs/health.pdf", cover:"covers/med.jpg", tags:["ØµØ­Ø©"] },
      { id:9,  cat:"eng",     title:"Ù…ÙØ§Ù‡ÙŠÙ… Ù‡Ù†Ø¯Ø³ÙŠØ© (Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ)", author:"â€”", pdf:"pdfs/engineering.pdf", cover:"covers/eng.jpg", tags:["Ù‡Ù†Ø¯Ø³Ø©"] },
      { id:10, cat:"soc",     title:"Ø¹Ù„Ù… Ø§Ù„Ù†ÙØ³ (Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ)", author:"â€”", pdf:"pdfs/psychology.pdf", cover:"covers/psy.jpg", tags:["Ù†ÙØ³","Ù…Ø¬ØªÙ…Ø¹"] },
      { id:11, cat:"dev",     title:"ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§Øª (Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ)", author:"â€”", pdf:"pdfs/self-dev.pdf", cover:"covers/dev.jpg", tags:["ØªÙ†Ù…ÙŠØ©"] },
      { id:12, cat:"variety", title:"Ù…Ù†ÙˆØ¹Ø§Øª (Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ)", author:"â€”", pdf:"pdfs/variety.pdf", cover:"covers/variety.jpg", tags:["Ù…Ù†ÙˆØ¹Ø§Øª"] },

      // Ø£Ù‚Ø³Ø§Ù… â€œØªØ§Ø¨Ø¹Ù†ÙŠ / Ø£Ø¹Ù„Ù† Ù„Ø¯ÙŠÙ†Ø§â€ ØºØ§Ù„Ø¨Ø§Ù‹ Ù…Ø§ ØªÙƒÙˆÙ† Ø±ÙˆØ§Ø¨Ø·ØŒ Ù‡Ù†Ø§ Ù†Ø®Ù„ÙŠÙ‡Ø§ ÙƒØªØ¨/Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙÙŠØ©
      { id:13, cat:"follow",  title:"Ø·Ø±Ù‚ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©", author:"Ù‚Ù†ÙˆØ§ØªÙŠ ÙˆØ±ÙˆØ§Ø¨Ø·ÙŠ", pdf:"pdfs/follow.pdf", cover:"covers/follow.jpg", tags:["Ø±ÙˆØ§Ø¨Ø·"] },
      { id:14, cat:"ads",     title:"Ø¥Ø¹Ù„Ø§Ù†/Ø±Ø¹Ø§ÙŠØ©", author:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†", pdf:"pdfs/ads.pdf", cover:"covers/ads.jpg", tags:["Ø¥Ø¹Ù„Ø§Ù†"] },
    ];

    const state = {
      activeCat: null,
      q: ""
    };

    const els = {
      catsGrid: document.getElementById("catsGrid"),
      booksGrid: document.getElementById("booksGrid"),
      searchInput: document.getElementById("searchInput"),
      booksTitle: document.getElementById("booksTitle"),
      booksSub: document.getElementById("booksSub"),
      emptyBox: document.getElementById("emptyBox"),
      countsText: document.getElementById("countsText"),
    };

    function safeText(s){ return String(s ?? ""); }

    function countBooksByCat(catId){
      return BOOKS.filter(b => b.cat === catId).length;
    }

    function renderCategories(){
      els.catsGrid.innerHTML = "";

      // Ø¥Ø¬Ù…Ø§Ù„ÙŠ
      els.countsText.textContent = `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒØªØ¨: ${BOOKS.length}`;

      CATEGORIES.forEach(cat => {
        const btn = document.createElement("button");
        btn.className = "catBtn" + (state.activeCat === cat.id ? " active" : "");
        const c = countBooksByCat(cat.id);

        btn.innerHTML = `
          <div class="catLeft">
            <div class="catEmoji">${cat.emoji}</div>
            <div class="catName">${safeText(cat.name)}</div>
          </div>
          <div class="catCount">${c}</div>
        `;

        btn.addEventListener("click", ()=>{
          state.activeCat = cat.id;
          renderCategories();
          renderBooks();
          // Ù†Ø²Ù‘Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù‚Ø³Ù… Ø§Ù„ÙƒØªØ¨ Ø¨Ø¹Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø³Ù… (Ù„Ø·ÙŠÙ Ù„Ù„Ø¬ÙˆØ§Ù„)
          document.getElementById("booksTitle").scrollIntoView({behavior:"smooth", block:"start"});
        });

        els.catsGrid.appendChild(btn);
      });
    }

    function matchesSearch(book){
      const q = state.q.trim().toLowerCase();
      if(!q) return true;
      const t = (book.title || "").toLowerCase();
      const a = (book.author || "").toLowerCase();
      return t.includes(q) || a.includes(q);
    }

    function renderBooks(){
      els.booksGrid.innerHTML = "";
      els.emptyBox.style.display = "none";

      if(!state.activeCat){
        els.booksTitle.textContent = "Ø§Ù„ÙƒØªØ¨";
        els.booksSub.textContent = "Ø§Ø®ØªØ± Ù‚Ø³Ù… Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙƒØªØ¨.";
        els.emptyBox.style.display = "block";
        els.emptyBox.innerHTML = "ğŸ‘† Ø§Ø®ØªØ± Ù‚Ø³Ù… Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ØŒ Ø«Ù… Ø¨ØªØ¸Ù‡Ø± Ù„Ùƒ Ø§Ù„ÙƒØªØ¨ Ù‡Ù†Ø§.";
        return;
      }

      const cat = CATEGORIES.find(c => c.id === state.activeCat);
      const baseList = BOOKS.filter(b => b.cat === state.activeCat);
      const list = baseList.filter(matchesSearch);

      els.booksTitle.textContent = `Ø§Ù„ÙƒØªØ¨ â€” ${cat ? cat.name : ""}`;
      els.booksSub.textContent = state.q
        ? `Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ø³Ù… (${list.length}/${baseList.length})`
        : `Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªØ¨ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…: ${baseList.length}`;

      if(list.length === 0){
        els.emptyBox.style.display = "block";
        els.emptyBox.innerHTML =
          state.q
          ? "ğŸ” Ù…Ø§ Ù„Ù‚ÙŠÙ†Ø§ Ù†ØªØ§Ø¦Ø¬â€¦ Ø¬Ø±Ù‘Ø¨ ÙƒÙ„Ù…Ø© Ø«Ø§Ù†ÙŠØ©."
          : "ğŸ“­ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… ÙØ§Ø¶ÙŠ Ø­Ø§Ù„ÙŠØ§Ù‹â€¦ Ø£Ø¶Ù ÙƒØªØ¨ (PDF) ÙˆØ¨ÙŠØ¸Ù‡Ø±ÙˆÙ† Ù‡Ù†Ø§.";
        return;
      }

      list.forEach(book => {
        const card = document.createElement("div");
        card.className = "bookCard";

        const cover = safeText(book.cover) || "";
        const pdf = safeText(book.pdf) || "#";
        const title = safeText(book.title) || "Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†";
        const author = safeText(book.author) || "";

        const tags = Array.isArray(book.tags) ? book.tags : [];

        card.innerHTML = `
          <div class="cover">
            <img
              src="${cover}"
              alt="${title}"
              onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,${encodeURIComponent(makePlaceholderSVG(title))}'"
            />
          </div>
          <div class="bookBody">
            <h3 class="bookTitle">${title}</h3>
            <p class="bookAuthor">${author}</p>

            <div class="bookMeta">
              ${tags.slice(0,4).map(t => `<span class="tag">${safeText(t)}</span>`).join("")}
            </div>

            <div class="btnRow">
              <a class="btn" href="${pdf}" target="_blank" rel="noopener">Ù‚Ø±Ø§Ø¡Ø© PDF ğŸ“„</a>
              <button class="btn secondary" type="button" data-copy="${pdf}">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ğŸ”—</button>
            </div>
          </div>
        `;

        // Ø²Ø± Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·
        card.querySelector('[data-copy]')?.addEventListener("click", async (e)=>{
          const link = e.currentTarget.getAttribute("data-copy") || "";
          try{
            await navigator.clipboard.writeText(link);
            e.currentTarget.textContent = "ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…";
            setTimeout(()=> e.currentTarget.textContent = "Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ğŸ”—", 1200);
          }catch(err){
            alert("Ù…Ø§ Ù‚Ø¯Ø±Øª Ø£Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø². Ø§Ù†Ø³Ø®Ù‡ ÙŠØ¯ÙˆÙŠÙ‹Ø§:\n" + link);
          }
        });

        els.booksGrid.appendChild(card);
      });
    }

    // placeholder SVG Ù„Ù„ØºÙ„Ø§Ù Ø¥Ø°Ø§ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø§ Ø§Ø´ØªØºÙ„Øª
    function makePlaceholderSVG(title){
      const t = (title || "").slice(0, 18);
      return `
        <svg xmlns="http://www.w3.org/2000/svg" width="800" height="600">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#1b3a78"/>
              <stop offset="1" stop-color="#0b1630"/>
            </linearGradient>
          </defs>
          <rect width="100%" height="100%" fill="url(#g)"/>
          <rect x="32" y="32" width="736" height="536" rx="28" fill="rgba(255,255,255,0.06)" stroke="rgba(255,255,255,0.15)"/>
          <text x="50%" y="52%" dominant-baseline="middle" text-anchor="middle"
                font-family="Tahoma, Arial" font-size="44" fill="rgba(255,255,255,0.85)">
            ${escapeXml(t)}
          </text>
          <text x="50%" y="62%" dominant-baseline="middle" text-anchor="middle"
                font-family="Tahoma, Arial" font-size="22" fill="rgba(255,255,255,0.55)">
            ØºÙ„Ø§Ù ØºÙŠØ± Ù…ØªÙˆÙØ±
          </text>
        </svg>
      `.trim();
    }

    function escapeXml(unsafe){
      return String(unsafe).replace(/[<>&'"]/g, (c)=>({
        "<":"&lt;", ">":"&gt;", "&":"&amp;", "'":"&apos;", '"':"&quot;"
      }[c]));
    }

    // Ø§Ù„Ø¨Ø­Ø«
    els.searchInput.addEventListener("input", (e)=>{
      state.q = e.target.value || "";
      renderBooks();
    });

    // ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ
    renderCategories();
    renderBooks();
  </script>
</body>
</html>
